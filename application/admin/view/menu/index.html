{include file="public/header" /}
<div class="layui-fluid">
    <div class="layui-card">
        <div class="layui-form layui-card-header layuiadmin-card-header-auto">
            <div class="layui-form-item">
                <div class="layui-inline">
                    <button class="layui-btn layuiadmin-btn-admin" data-type="add">{$Think.lang.add_menu}</button>
                </div>
            </div>
        </div>

        <div class="layui-card-body">
            <table id="LAY-user-back-manage" lay-filter="LAY-user-back-manage">
            </table>
            <script type="text/html" id="styleCss">
                <i class="layui-icon {{d.css}}"></i> &nbsp;<cite>{{d.css}}</cite>
            </script>
            <script type="text/html" id="buttonTpl">
                {{#  if(d.status == true){ }}
                <button class="layui-btn layui-btn-xs" lay-event="status" lay-data="{{d.status}}">{$Think.lang.open}</button>
                {{#  } else { }}
                <button class="layui-btn layui-btn-danger layui-btn-xs" lay-event="status" lay-data="{{d.status}}">{$Think.lang.close}</button>
                {{#  } }}
            </script>
            <script type="text/html" id="title">
                {{d.lefthtml}}{{d.title}}
            </script>
            <script type="text/html" id="table-useradmin-admin">
                <a class="layui-btn layui-btn-sm" lay-event="edit"><i class="layui-icon layui-icon-edit"></i>{$Think.lang.edit}</a>
                <a class="layui-btn layui-btn-danger layui-btn-sm" lay-event="del"><i class="layui-icon layui-icon-delete"></i></a>
            </script>
        </div>
<!--        <div class="layui-form layui-card-header layuiadmin-card-header-auto">
            <div class="layui-form-item" align="right">
                <div class="layui-inline">
                    <button class="layui-btn layuiadmin-btn-admin" data-type="sort">{$Think.lang.update_sort}</button>
                </div>
            </div>
        </div>-->
    </div>
</div>
{include file="public/footer" /}
<script>
    var listUrl = 'index';          //当前列表 URL
    var addEditUrl = 'editMenu';    //新增、编辑
    var delUrl = 'delMenu';         //删除当前角色
    var stateUrl = 'menuState';     //菜单状态
    var sortUrl = 'menuOrder';

    //动态表格
    layui.use('table',function () {
        var $ = layui.$;
        var table = layui.table;

        //执行渲染 - 实例 Table
        table.render({
            elem:'#LAY-user-back-manage',
            url:listUrl,
            page:false,
            cols:[{$cell|getCell|raw}]
        });

        //监听动态表格中的事件
        table.on("tool(LAY-user-back-manage)",function(e){
            //e.data;   当前行数据
            var id = e.data.id;
            switch (e.event) {
                case 'edit':
                    //编辑
                    var url = addEditUrl+"?id="+id;
                    var area = ['60%','80%'];
                    tpmsg.addEdit(url,area,"{:lang('edit_menu')}");
                    break;
                case 'del':
                    //删除
                    tpmsg.confirm(id,delUrl);
                    break;
                case 'status':
                    //状态
                    tpmsg.status(id,stateUrl,this);
                    break;
            }
        });

        //监听表格上列的添加、搜索框事件
        $('.layui-btn.layuiadmin-btn-admin').on('click', function(){
            var type = $(this).data('type');
            switch (type) {
                case 'add':
                    var url = addEditUrl;
                    var area = ['40%','80%'];
                    tpmsg.addEdit(url,area,"{:lang('add_menu')}");
                    break;
                case 'batchdel':
                    tpmsg.batchdel(delUrl);
                    break;
                case 'sort':
                    break;
            }
        });
    });
</script>